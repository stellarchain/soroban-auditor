use crate::decompile::DataSegment;
use crate::fingerprint::Fingerprint;
use crate::wasm_ir::Function;
use parity_wasm::elements::{FuncBody, FunctionType};
use std::io::Write;

pub fn suggested_name_for_fingerprint(fingerprint: &Fingerprint) -> Option<&'static str> {
    match fingerprint.hash {
        0xb1d5ab9d54552386 => Some("entry_decode"),
        0x1009eee0145251ab => Some("vec_pair_iter"),
        0x879c5f6c8e7ccaf7 => Some("decode_val_or_error"),
        0xdb7c15da4a0100b1 => Some("copy_val_if_present"),
        0x4dc2a27373875c29 => Some("write_ok_val"),
        0x7123f936ad42eb61 => Some("storage_get_val"),
        0xa2a432aa2d1fc87d => Some("map_unpack_to_val"),
        0xb6b622399f6cd662 => Some("val_to_i64_checked"),
        0x0b46848e2c70879d => Some("check_recent_timestamp"),
        0xcb8bc1b0363e5c87 => Some("storage_set_val"),
        0x0bba25866190612f => Some("storage_key_from_str"),
        0x9d0bda6242cf05dd => Some("result_unwrap_or_panic"),
        0xd9b6ed776a84028c => Some("result_from_val_unchecked"),
        0xa1ffe0a52367d6e1 => Some("result_from_val"),
        0x937cf98725c5ce93 => Some("require_owner_auth"),
        0x9a262c0072f8c409 => Some("require_auth_for_key"),
        0x4272f3bcef47b5f6 => Some("read_prices_loop"),
        0x9e5b7725c3501de7 => Some("write_prices_impl"),
        0xda81fcbe9ede3f70 => Some("map_new_val"),
        0x7896ef8f57401c71 => Some("init_owner_internal"),
        0xfe1f3f06a749dd3c => Some("set_pending_owner_internal"),
        0x65894f641b4e7637 => Some("accept_ownership_internal"),
        0x99ee79378e08c33d => Some("storage_remove_val"),
        0x950c57d29576441f => Some("cancel_pending_owner_internal"),
        0x10e1cafa5cc73328 => Some("upgrade_wasm_internal"),
        0x30fb0e969eaddad1 => Some("read_timestamp_val"),
        0xc01829002e3dc9f7 => Some("read_price_data_for_feed_val"),
        0xe2f2ba431b096cb6 => Some("check_price_data_val"),
        0x647b009204d6332d => Some("decode_error_from_val"),
        0x1f151b05224cb69f => Some("ledger_timestamp_val"),
        0x5061910c5e571ce1 => Some("bytes_to_fixed32_struct"),
        0x00b4ff08e04e697f => Some("get_prices_impl"),
        0x86b014f96e71aec5 => Some("dispatch_table"),
        0x9acb1bdbb4f5953e => Some("alloc_trap"),
        0x0b022d3cb5c62c80 => Some("alloc_realloc"),
        0x07026fc0ea266fa7 => Some("alloc_size_align"),
        0xa925555186d08445 => Some("alloc_core"),
        0x07699f75c970dbb6 => Some("build_entry_from_bytes"),
        0x627d5b4ca0d455a5 => Some("entry_match_copy"),
        0x0452222ee75faff8 => Some("entry_copy_if_ok"),
        0x3bcac7da12f21925 => Some("entry_from_bytes_val"),
        0xc5d0fa81f6ec8912 => Some("alloc_range_fill"),
        0x81246b72c9f87605 => Some("alloc_range"),
        0x263e051d2f5ebb27 => Some("alloc_range_one"),
        0xec0e4fe013b81985 => Some("alloc_copy"),
        0xf7d64f41080eec9b => Some("require_alloc"),
        0x24749d211cc73413 => Some("span_from_range"),
        0x12d3e998ce20e0f3 => Some("span_take"),
        0x10d6fbb841cd9d43 => Some("span_set"),
        0x1847b78abdb23830 => Some("memcpy_checked"),
        0xf5e1308c33e7f13d => Some("memmove"),
        0x3cc5936dca5012a7 => Some("memcmp"),
        0xca687ee8429aafd5 => Some("memcmp_sign32"),
        0x2562423c21425ae1 => Some("memeq32"),
        0xb7569875fc80cae4 => Some("ptr_index32"),
        0x9050d9a54155ed34 => Some("copy_to_linear_memory"),
        0x62de53692a71ca0a => Some("vec_next_string_flag"),
        0x6154e70a5ff920c0 => Some("guard_nonzero_ptr"),
        0x0974f7c88ff97554 => Some("vec_next_string_to_linear"),
        0x6a35c4e8ca5e1033 => Some("bytes_to_fixed32"),
        0x256576a6ea8f6e64 => Some("pack_u32_call_import"),
        0x653f3babe0f53681 => Some("call_eq_one"),
        0x364ac65856297d45 => Some("call_unreachable"),
        0x953734e6ccf68b58 => Some("unreachable_stub"),
        0x0db294ab5049420d => Some("nop"),
        _ => None,
    }
}



pub fn try_emit_raw_rewrite<W: Write>(
    writer: &mut W,
    function: &Function,
    fn_type: &FunctionType,
    fingerprint: &Fingerprint,
    body: &FuncBody,
    import_count: usize,
    functions: &[Function],
    data_segments: &[DataSegment],
) -> Result<bool, String> {
    let _ = (
        writer,
        function,
        fn_type,
        fingerprint,
        body,
        import_count,
        functions,
        data_segments,
    );
    Ok(false)
}
